<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Patient - Home</title>
    <!-- <link rel="stylesheet" href="../Patient/appointment/patientappointment.css"> -->
    <link href="../output.css" rel="stylesheet">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;700&display=swap" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.4/css/all.min.css" rel="stylesheet">
    <script src="../components/components-patient/navbarfetch-patients.js"></script>
    <script src="../components/footerfetch.js"></script>    
</head>
<body>
    <header>
        <div id="navbar-container"></div>
    </header>
    <main>
        <div class="content min-h-screen">
            <h1>WANT TO BOOK AN APPOINTMENT?</h1>
            <button class="next-button" onclick="goNextAppointment()">Next â†’ </button>
        </div>
    </main>
    <footer>
        <div id="footer-container"></div>
    </footer>
    <script>
        function goNextAppointment() {
            window.location.href = "../Patient/appointment/typeofpatient.html";
        }

        const mobileOpenButton = document.getElementById('mobile-open-button');
        const mobileMenu = document.getElementById('mobile-menu');

        mobileOpenButton.addEventListener('click', () => {
            const isHidden = mobileMenu.classList.contains('opacity-0');
            mobileMenu.classList.toggle('opacity-0', !isHidden);
            mobileMenu.classList.toggle('pointer-events-none', !isHidden);
            mobileMenu.classList.toggle('translate-y-0', isHidden);
            mobileMenu.classList.toggle('-translate-y-4', !isHidden);
            mobileOpenButton.innerHTML = isHidden ? '&#10005;' : '&#9776;';
        });

        function toggleDropdown(id) {
            const dropdown = document.getElementById(id);
            dropdown.classList.toggle('hidden');
        }

        window.toggleDropdown = toggleDropdown;

        // function displayProfileInfo(data) {
        //     const profileName = document.getElementById('profile-name');
        //     if (data.firstName && data.lastName) {
        //         profileName.innerText = `${data.firstName} ${data.lastName}`;  // Display full name after fetching data
        //     } else {
        //         profileName.innerText = 'Guest';  // Fallback in case the data is missing
        //     }
        // }

        // async function fetchProfile() {
        //     const response = await fetch('/api/patient/profile');
        //     if (response.ok) {
        //         const data = await response.json();
        //         displayProfileInfo(data);
        //     } else {
        //         console.error('Error fetching profile data');
        //     }
        // }

        // document.addEventListener('DOMContentLoaded', async () => {
        //     const profileName = document.getElementById('profile-name');
            
        //     // Set the initial profile name from sessionStorage (fallback to 'Guest')
        //     const userName = sessionStorage.getItem('firstName') || 'Loading...';
        //     profileName.textContent = userName;  // Display 'Loading...' until the data is fetched
            
        //     await fetchProfile();  // Fetch the profile data once the page is ready
        // });

        // async function fetchNotifications() {
        //     try {
        //         const response = await fetch("http://localhost:3000/api/notifications", {
        //             headers: { "Authorization": `Bearer ${localStorage.getItem("token")}` } // Ensure user authentication
        //         });

        //         if (!response.ok) throw new Error("Failed to fetch notifications");

        //         const data = await response.json();
        //         updateNotifications(data.notifications);
        //     } catch (error) {
        //         console.error("Error fetching notifications:", error);
        //     }
        // }

        // async function fetchNotificationCount() {
        //     try {
        //         const response = await fetch("http://localhost:3000/api/notifications/count", {
        //             headers: { "Authorization": `Bearer ${localStorage.getItem("token")}` }
        //         });

        //         if (!response.ok) throw new Error("Failed to fetch notification count");

        //         const data = await response.json();
        //         updateNotificationBadge(data.count);
        //     } catch (error) {
        //         console.error("Error fetching notification count:", error);
        //     }
        // }

        // function updateNotifications(notifications) {
        //     const badge = document.getElementById("notifBadge");
        //     const notifList = document.getElementById("notifList");
        //     notifList.innerHTML = "";

        //     if (notifications.length > 0) {
        //         badge.textContent = notifications.length;
        //         badge.style.display = "flex";

        //         notifications.forEach((notif) => {
        //             let item = document.createElement("div");
        //             item.className = "notification-item";
        //             item.textContent = notif.message;
        //             item.onclick = () => markNotificationAsRead(notif._id);
        //             notifList.appendChild(item);
        //         });
        //     } else {
        //         badge.style.display = "none";
        //         notifList.innerHTML = '<div class="notification-item">No new notifications</div>';
        //     }
        // }

        // function updateNotificationBadge(count) {
        //     const badge = document.getElementById("notifBadge");

        //     if (count > 0) {
        //         badge.textContent = count;
        //         badge.style.display = "flex";
        //     } else {
        //         badge.style.display = "none";
        //     }
        // }

        // async function markNotificationAsRead(notificationId) {
        //     try {
        //         await fetch(`http://localhost:3000/api/notifications/${notificationId}/mark-read`, {
        //             method: "PATCH",
        //             headers: {
        //                 "Content-Type": "application/json",
        //                 "Authorization": `Bearer ${localStorage.getItem("token")}`
        //             }
        //         });

        //         fetchNotifications(); // Refresh notifications after marking as read
        //         fetchNotificationCount();
        //     } catch (error) {
        //         console.error("Error marking notification as read:", error);
        //     }
        // }

        // function toggleNotifications() {
        //     document.getElementById("notifDropdown").classList.toggle("active");
        // }

        // // Initial fetch
        // fetchNotifications();
        // fetchNotificationCount();

        // // Fetch notifications every 10 seconds
        // setInterval(fetchNotifications, 10000);
        // setInterval(fetchNotificationCount, 10000);
    </script>
</body>
</html>